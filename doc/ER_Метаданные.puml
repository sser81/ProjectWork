@startuml

!include https://raw.githubusercontent.com/Kyrales/1C-ER-plantuml/refs/heads/extended/main.puml

title Диаграмма метаданных в подсистеме 'Limits for employees' 

package "Учетная система" #d3fffbff {

    package НСИ <<Frame>> #e4ff99ff {
        v8_Catalog(_DemoCompanies, "Demo: Companies"){
            Ссылка
        }

        v8_Catalog(_DemoDepartments, "Demo: Departments"){
            Ссылка
        }

        v8_Catalog(_DemoIndividuals, "Demo: Individuals"){
            Ссылка
        }

        v8_Catalog(CashFlowItems, "Cash Flow items"){
            Ссылка
        }
    }

    v8_Catalog(TypesOfLimitsForEmployees, "Types of limits for employees"){
        Ссылка
        Resource type
        Cash flow item
        One time
    }

    v8_Catalog(StageOfLimitsForEmployees, "Stage of limits for employees"){
        Ссылка
        Employment contract
        Type of limit
        Start date
        End date
        Description key
        }

    package "Установка лимитов" <<Frame>> #99c0ffff {

        v8_Document(EmploymentContract, "Employment contract"){
            Ссылка
            Entity
            Department
            Employee
            Period
            End-of-Contract Date
            Employee ID
            --ТЧ Limits for employees--
            TypeOfLimit
            Stage
            LimitDate
            LimitDateEnd
            Limit
        }

        v8_InfoRg(_DemoCompaniesEmployees, "Demo: Company employees"){
            <$d>Регистратор
            <$d>Organization
            <$d>Individual
            <$r>Department_Company
            <$r>OccupiedRates
            <$r>EmploymentContract
            EmployeeCode
            }

        v8_InfoRg(EmployeeLimitPlaning, "Employee limit planing"){
            <$d>Регистратор
            <$d>Entity
            <$d>Employee
            <$d>TypeOfLimit
            <$d>Stage
            <$r>Limit
            }
    }

    package "Контроль лимитов" <<Frame>> #84c39eff{

        v8_Document(ExpenseByLimits, "Expense by limits"){
            Ссылка
            Entity
            Employee
            --ТЧ Limits for employees--
            TypeOfLimit
            Stage
            Limit
        }

        v8_Document(Tickets){
            Ссылка
            Entity
            Employee
            TypeOfLimits
            StageOfLimit
            Count
        }

        v8_AccRg(TurnoverByEmployeeLimits, "Turnover by employee limits"){
            <$d>Регистратор
            <$d>Entity
            <$d>Employee
            <$d>TypeOfLimit
            <$d>Stage
            <$r>Limit
        }

    }

'Ссылки на основные НСИ
_DemoCompanies-->EmploymentContract : Entity
_DemoIndividuals-->EmploymentContract : Employee

_DemoCompanies-->_DemoCompaniesEmployees : Organization
_DemoDepartments-->_DemoCompaniesEmployees : Department_Company
_DemoIndividuals-->_DemoCompaniesEmployees : Individual

_DemoCompanies-->EmployeeLimitPlaning : Entity
_DemoIndividuals-->EmployeeLimitPlaning : Employee

_DemoCompanies-->Tickets : Entity
_DemoIndividuals-->Tickets : Employee

_DemoCompanies-->ExpenseByLimits : Entity
_DemoIndividuals-->ExpenseByLimits : Employee

_DemoCompanies-->TurnoverByEmployeeLimits : Entity
_DemoIndividuals-->TurnoverByEmployeeLimits : Employee

CashFlowItems-down->TypesOfLimitsForEmployees : CashFlowItem

'Ссылки в этапах
TypesOfLimitsForEmployees-left->StageOfLimitsForEmployees : TypeOfLimit
EmploymentContract-->StageOfLimitsForEmployees : EmploymentContract

'Установка лимитов
TypesOfLimitsForEmployees-->EmploymentContract : TypeOfLimit

EmploymentContract-->_DemoCompaniesEmployees : EmploymentContract

TypesOfLimitsForEmployees-->EmployeeLimitPlaning : TypeOfLimit
StageOfLimitsForEmployees-down->EmployeeLimitPlaning : Stage
EmploymentContract-->EmployeeLimitPlaning

'Расход лимитов
TypesOfLimitsForEmployees-->ExpenseByLimits : TypeOfLimit
StageOfLimitsForEmployees-->ExpenseByLimits : Stage

TypesOfLimitsForEmployees-->Tickets : TypeOfLimits
StageOfLimitsForEmployees-->Tickets : StageOfLimit

TypesOfLimitsForEmployees-->TurnoverByEmployeeLimits : TypeOfLimit
StageOfLimitsForEmployees-->TurnoverByEmployeeLimits : Stage

ExpenseByLimits -->TurnoverByEmployeeLimits
Tickets-->TurnoverByEmployeeLimits

}

package СЭД #d3fffbff {

    package "НСИ" <<Frame>> #e4ff99ff {

        v8_Catalog(Организации){
            Ссылка
        }

        v8_Catalog(Сотрудники){
            Ссылка
        }
    
        v8_Catalog(СтатьиДвиженияДенежныхСредств, "Статьи движения денежных средств"){
            Ссылка
        }
    
    }

    v8_Catalog(ЭтапыЛимитовСотрудников, "Этапы лимитов сотрудников"){
        Ссылка
        Владелец
        СтатьяДвиженияДенежныхСредств
        НаименованиеКлюч
        ДатаНачала
        ДатаОкончания
        }
    
    v8_Catalog(ДокументыПредприятия, "Документы"){
        Ссылка
        Организация
        Сотрудник
        СтатьяДвиженияДенежныхСредств
        Этап
        Сумма
    }

    Сотрудники-->ЭтапыЛимитовСотрудников : Владелец
    СтатьиДвиженияДенежныхСредств-->ЭтапыЛимитовСотрудников : СтатьяДвиженияДенежныхСредств

    Организации-down->ДокументыПредприятия : Организация
    Сотрудники-down->ДокументыПредприятия : Сотрудник
    СтатьиДвиженияДенежныхСредств-down->ДокументыПредприятия : СтатьяДвиженияДенежныхСредств
    ЭтапыЛимитовСотрудников-left->ДокументыПредприятия : Этап
}

@enduml